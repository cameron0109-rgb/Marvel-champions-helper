<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Marvel Champions Trial: Spider-Man vs Rhino</title>
<style>
body { font-family: Arial, sans-serif; margin:10px; background:#f0f0f0; }
h2 { margin-top:20px; }
.card { border:1px solid #333; background:#fff; padding:5px; margin:2px; display:inline-block; width:120px; vertical-align:top; }
.btn { margin:2px; padding:5px; }
#setup, #gameArea { margin-top:20px; padding:10px; background:#ddd; }
.section { margin-top:15px; padding:5px; background:#eee; }
</style>
</head>
<body>
<h1>Marvel Champions Trial: Spider-Man vs Rhino</h1>

<div id="setup">
<h2>Setup</h2>
<label>Choose Villain:
<select id="villainSelect"><option value="rhino">Rhino</option></select>
</label><br>
<label>Difficulty:
<select id="difficultySelect"><option value="1">Normal (1+2)</option><option value="2">Expert (2+3)</option></select>
</label><br>
<label>Modular Side Schemes:</label><br>
<input type="checkbox" id="modBomb"> Bomb Scare<br>
<input type="checkbox" id="modHydra"> Hydra Agents<br>
<button class="btn" onclick="startGame()">Start Game</button>
</div>

<div id="gameArea" style="display:none;">
<h2>Hero Area</h2>
<div id="heroInfo"></div>
<div id="heroHand"></div>
<button class="btn" onclick="drawHeroCard()">Draw Card</button>
<button class="btn" onclick="discardForResource()">Discard for Resource</button>
<button class="btn" onclick="useHeroAbility('attack')">Attack</button>
<button class="btn" onclick="useHeroAbility('thwart')">Thwart</button>
<button class="btn" onclick="useHeroAbility('defend')">Defend</button>
<button class="btn" onclick="useHeroAbility('ability')">Use Form Ability</button>
<button class="btn" onclick="endHeroTurn()">End Turn</button>
<button class="btn" onclick="readyHero()">Ready Hero</button>

<h2>Villain Area</h2>
<div id="villainInfo"></div>
<div id="villainCard"></div>

<h2>Schemes</h2>
<div id="mainSchemeInfo"></div>
<div id="sideSchemesInfo"></div>
</div>

<script>
// ------------------- Data -------------------
let hero = {
name:"Spider-Man",
hp:10,
currentForm:"alter",
exhausted:false,
resources:0,
hand:[],
deck:[],
discard:[],
forms:{
hero:{abilities:["Web-Shooters"], hp:10},
alter:{abilities:["Spider-Sense"], hp:null}
}
};

// Full Spider-Man deck (text only)
hero.deck = [
{name:"Web-Shooters", cost:2, type:"upgrade", attack:2, thwart:0, defend:0, text:"Basic attack upgrade"},
{name:"Spider-Sense", cost:1, type:"event", attack:0, thwart:0, defend:0, text:"Response: after attack"},
{name:"Quick Reflexes", cost:1, type:"event", attack:0, thwart:0, defend:0, text:"Ready your hero"},
{name:"Ally: Black Cat", cost:3, type:"ally", attack:2, thwart:0, defend:0, text:"Ally attack"},
{name:"Web Grenade", cost:2, type:"event", attack:1, thwart:1, defend:0, text:"Attack + Thwart"},
{name:"Acrobatic Maneuvers", cost:2, type:"event", attack:0, thwart:1, defend:1, text:"Thwart + Defend"},
{name:"Spider-Bots", cost:3, type:"upgrade", attack:1, thwart:1, defend:0, text:"Attack & Thwart"},
{name:"MJ Ally", cost:3, type:"ally", attack:0, thwart:2, defend:0, text:"Thwart ally"},
{name:"Adrenaline Rush", cost:1, type:"event", attack:1, thwart:0, defend:0, text:"Attack and ready hero"},
{name:"Web Sling", cost:2, type:"event", attack:2, thwart:0, defend:0, text:"Attack"},
{name:"Spider Climb", cost:1, type:"event", attack:0, thwart:0, defend:1, text:"Defend"},
{name:"Web Net", cost:2, type:"event", attack:0, thwart:2, defend:0, text:"Thwart"}
];

let villain = {
name:"Rhino",
hp:30,
stage:1,
deck:[],
discard:[],
sideSchemes:[],
stats:{attack:5, thwart:3}
};

// Full Rhino encounter deck with modular options
villain.deck = [
{name:"Rhino Charge", type:"attack", attack:3, modifier:1, text:"Attack hero"},
{name:"Trample", type:"attack", attack:4, modifier:0, text:"Attack hero"},
{name:"Main Scheme Threat", type:"thwart", thwart:2, modifier:0, text:"Add threat to main scheme"},
{name:"Minion Reinforcements", type:"minion", attack:1, thwart:1, modifier:0, text:"Spawn minion"},
{name:"Stomp", type:"attack", attack:2, modifier:1, text:"Attack hero"},
{name:"Rampage", type:"attack", attack:3, modifier:2, text:"Attack hero"},
{name:"Side Scheme Threat", type:"thwart", thwart:1, modifier:0, text:"Threat added to side scheme"}
];

let mainScheme = {name:"Main Scheme", threat:0, maxThreat:10};
let sideSchemes = [];

// ------------------- Functions -------------------
function shuffle(array){ return array.sort(()=>Math.random()-0.5); }

function startGame(){
document.getElementById('setup').style.display="none";
document.getElementById('gameArea').style.display="block";

// Setup modular side schemes
sideSchemes = [];
if(document.getElementById('modBomb').checked) sideSchemes.push({name:"Bomb Scare", threat:0, maxThreat:5, advanceEffect:()=>{alert("Bomb explodes!");}});
if(document.getElementById('modHydra').checked) sideSchemes.push({name:"Hydra Agents", threat:0, maxThreat:4, advanceEffect:()=>{alert("Hydra agents spawn!");}});

hero.hand = [];
hero.discard = [];
hero.resources = 0;
hero.exhausted = false;
shuffle(hero.deck);
shuffle(villain.deck);
renderHero();
renderVillain();
renderSchemes();
}

function renderHero(){
let h = `<b>Name:</b> ${hero.name} (${hero.currentForm})<br>
<b>HP:</b> ${hero.forms[hero.currentForm].hp || "-"}<br>
<b>Resources:</b> ${hero.resources}<br>
<b>Exhausted:</b> ${hero.exhausted ? "Yes" : "No"}<br>
<b>Deck:</b> ${hero.deck.length} cards | <b>Discard:</b> ${hero.discard.length}`;
document.getElementById('heroInfo').innerHTML = h;

let handHtml = "";
hero.hand.forEach(c=>{
handHtml += `<div class="card">${c.name} (Cost:${c.cost})<br>${c.text}<br>Atk:${c.attack} Thw:${c.thwart} Def:${c.defend}</div>`;
});
document.getElementById('heroHand').innerHTML = handHtml;
}

function drawHeroCard(){
if(hero.deck.length === 0){
if(hero.discard.length === 0){ alert("No cards to draw!"); return; }
hero.deck = [...hero.discard];
hero.discard = [];
shuffle(hero.deck);
alert("Hero deck reshuffled!");
}
let card = hero.deck.pop();
hero.hand.push(card);
renderHero();
}

function discardForResource(){
if(hero.hand.length === 0){ alert("No cards to discard!"); return; }
let discarded = hero.hand.pop();
hero.discard.push(discarded);
hero.resources += 1;
renderHero();
}

function useHeroAbility(action){
if(hero.exhausted){ alert("Hero exhausted!"); return; }
let h = hero.forms[hero.currentForm];
switch(action){
case "attack": alert("Attack performed"); break;
case "thwart": alert("Thwart performed"); break;
case "defend": alert("Defend performed"); break;
case "ability": alert(`Used ability: ${h.abilities.join(", ")}`); break;
}
hero.exhausted = true;
renderHero();
}

function readyHero(){ hero.exhausted=false; renderHero(); }

function renderVillain(){
document.getElementById('villainInfo').innerHTML = `<b>Name:</b> ${villain.name} | HP:${villain.hp} | Stage:${villain.stage}<br>
Deck: ${villain.deck.length} | Discard: ${villain.discard.length}`;
}

function renderSchemes(){
document.getElementById('mainSchemeInfo').innerHTML = `<b>${mainScheme.name}</b>: Threat ${mainScheme.threat}/${mainScheme.maxThreat}`;
let sideHtml = "";
sideSchemes.forEach(s=>{ sideHtml += `<b>${s.name}</b>: Threat ${s.threat}/${s.maxThreat}<br>`; });
document.getElementById('sideSchemesInfo').innerHTML = sideHtml;
}

function endHeroTurn(){
alert("Hero turn ends. Villain phase starts!");
villainPhase();
}

function villainPhase(){
if(villain.deck.length < 2){
reshuffleVillainDeck();
}
let first = villain.deck.pop(); villain.discard.push(first);
alert(`Villain reveals: ${first.name} (Modifier:${first.modifier})`);
applyVillainCard(first);
let second = villain.deck.pop(); villain.discard.push(second);
alert(`Villain draws: ${second.name} for action`);
applyVillainCard(second);
renderHero(); renderVillain(); renderSchemes();
alert("Villain phase ends. Your turn!");
}

function applyVillainCard(card){
let mod = card.modifier || 0;
switch(card.type){
case "attack":
let dmg = (card.attack||0) + mod;
if(hero.currentForm==="hero") hero.forms.hero.hp -= dmg;
else mainScheme.threat += dmg;
break;
case "thwart":
let thw = (card.thwart||0) + mod;
mainScheme.threat += thw;
break;
case "minion":
alert("Minion spawned: "+card.name);
break;
case "scheme":
mainScheme.threat += (card.threat||0) + mod;
break;
}
}

function reshuffleVillainDeck(){
villain.deck = [...villain.discard];
villain.discard = [];
shuffle(villain.deck);
alert("Villain deck reshuffled!");
}
</script>
</body>
</html>
